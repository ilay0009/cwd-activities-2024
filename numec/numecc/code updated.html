<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matrix Calculator - Inverse and Determinant</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background: #f0f4f8;
            color: #333;
        }
        .container {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            max-width: 800px;
            width: 100%;
            text-align: center;
        }
        h2 {
            color: #4a90e2;
        }
        label, select {
            font-weight: bold;
            color: #555;
        }
        select {
            padding: 5px;
            margin: 10px 0;
            border-radius: 4px;
            border: 1px solid #ccc;
        }
        .matrix-row {
            display: flex;
            justify-content: center;
        }
        .matrix-cell {
            width: 60px;
            margin: 5px;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            text-align: center;
            font-size: 16px;
        }
        button {
            background-color: #4a90e2;
            color: #fff;
            padding: 10px 20px;
            font-size: 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        button:hover {
            background-color: #357ABD;
        }
        .result {
            margin-top: 10px;
            text-align: left;
        }
        .result-title {
            font-weight: bold;
            color: #333;
            font-size: 18px;
            margin: 10px 0 5px;
        }
        .solution-step {
            font-size: 14px;
            color: #666;
            white-space: pre-wrap;
            line-height: 1.5;
        }
        .step {
            margin: 5px 0;
        }
        .matrix {
            display: inline-block;
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background: #f9f9f9;
        }
    </style>
</head>
<body>

    <div class="container">
        <h2>Matrix Calculator</h2>

        <label for="matrixSize">Choose Matrix Size:</label>
        <select id="matrixSize" onchange="generateMatrix()">
            <option value="">Select size</option>
            <option value="1x1">1x1</option>
            <option value="1x2">1x2</option>
            <option value="1x3">1x3</option>
            <option value="1x4">1x4</option>
            <option value="2x1">2x1</option>
            <option value="2x2">2x2</option>
            <option value="2x3">2x3</option>
            <option value="2x4">2x4</option>
            <option value="3x1">3x1</option>
            <option value="3x2">3x2</option>
            <option value="3x3">3x3</option>
            <option value="3x4">3x4</option>
            <option value="4x1">4x1</option>
            <option value="4x2">4x2</option>
            <option value="4x3">4x3</option>
            <option value="4x4">4x4</option>
        </select>

        <div id="matrixContainer" class="matrix-container"></div>

        <button onclick="calculate()">Calculate</button>

        <div class="result">
            <div class="result-title">Determinant:</div>
            <p id="determinant"></p>
        </div>
        <div class="result">
            <div class="result-title">Inverse:</div>
            <div id="inverse" class="matrix"></div>
        </div>
        <div class="result">
            <div class="result-title">Determinant Steps:</div>
            <div id="determinantSteps" class="solution-step"></div>
        </div>
        <div class="result">
            <div class="result-title">Inverse Steps:</div>
            <div id="inverseSteps" class="solution-step"></div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/10.1.1/math.min.js"></script>
    <script>
        function generateMatrix() {
            const matrixSize = document.getElementById("matrixSize").value;
            const [rows, cols] = matrixSize.split("x").map(Number);
            const matrixContainer = document.getElementById("matrixContainer");

            matrixContainer.innerHTML = ""; // Clear existing fields

            for (let i = 0; i < rows; i++) {
                const rowDiv = document.createElement("div");
                rowDiv.className = "matrix-row";

                for (let j = 0; j < cols; j++) {
                    const cellInput = document.createElement("input");
                    cellInput.type = "number";
                    cellInput.className = "matrix-cell";
                    cellInput.id = `cell-${i}-${j}`;
                    cellInput.placeholder = `a${i+1}${j+1}`;
                    rowDiv.appendChild(cellInput);
                }

                matrixContainer.appendChild(rowDiv);
            }
        }

        function calculate() {
            const matrixSize = document.getElementById("matrixSize").value;
            if (!matrixSize) {
                alert("Please select a matrix size.");
                return;
            }

            const [rows, cols] = matrixSize.split("x").map(Number);
            const matrix = [];
            for (let i = 0; i < rows; i++) {
                const row = [];
                for (let j = 0; j < cols; j++) {
                    const value = parseFloat(document.getElementById(`cell-${i}-${j}`).value) || 0;
                    row.push(value);
                }
                matrix.push(row);
            }

            try {
                const numericMatrix = math.matrix(matrix);
                const determinant = math.det(numericMatrix);
                document.getElementById("determinant").innerText = determinant.toFixed(2);
                document.getElementById("determinantSteps").innerHTML = calculateDeterminantSteps(matrix);

                if (rows === cols) {
                    if (determinant !== 0) {
                        const inverseMatrix = math.inv(numericMatrix);
                        document.getElementById("inverse").innerHTML = matrixToString(inverseMatrix);
                        document.getElementById("inverseSteps").innerHTML = calculateInverseSteps(matrix, inverseMatrix);
                    } else {
                        document.getElementById("inverse").innerText = "This matrix is singular and cannot be inverted.";
                        document.getElementById("inverseSteps").innerText = "";
                    }
                } else {
                    document.getElementById("inverse").innerText = "Only square matrices have inverses.";
                    document.getElementById("inverseSteps").innerText = "";
                }
            } catch (error) {
                document.getElementById("determinant").innerText = "Error in calculation.";
                document.getElementById("inverse").innerText = "";
                document.getElementById("determinantSteps").innerText = "";
                document.getElementById("inverseSteps").innerText = "";
            }
        }

        function matrixToString(matrix) {
            return matrix._data.map(row => row.map(val => `(${val.toFixed(2)})`).join(" ")).join("<br/>");
        }

        function calculateDeterminantSteps(matrix) {
            const rows = matrix.length;
            let steps = "";

            if (rows === 1) {
                steps = `Determinant of 1x1 matrix is the single element: (${matrix[0][0]})`;
            } else if (rows === 2) {
                const a11 = matrix[0][0], a12 = matrix[0][1];
                const a21 = matrix[1][0], a22 = matrix[1][1];
                const determinant = a11 * a22 - a12 * a21;
                steps = `Determinant of 2x2 matrix:\n (a11 * a22) - (a12 * a21) = (${a11} * ${a22}) - (${a12} * ${a21}) = ${determinant}`;
            } else if (rows === 3) {
                const [a, b, c] = matrix;
                const determinant =
                    a[0] * (b[1] * c[2] - b[2] * c[1]) -
                    a[1] * (b[0] * c[2] - b[2] * c[0]) +
                    a[2] * (b[0] * c[1] - b[1] * c[0]);
                steps = `Determinant of 3x3 matrix:\n = ${a[0]} * [(${b[1]} * ${c[2]}) - (${b[2]} * ${c[1]})] - ${a[1]} * [(${b[0]} * ${c[2]}) - (${b[2]} * ${c[0]})] + ${a[2]} * [(${b[0]} * ${c[1]}) - (${b[1]} * ${c[0]})]\n = ${determinant}`;
            } else if (rows === 4) {
                const [a, b, c, d] = matrix;
                const determinant =
                    a[0] * (
                        b[1] * (c[2] * d[3] - c[3] * d[2]) -
                        b[2] * (c[1] * d[3] - c[3] * d[1]) +
                        b[3] * (c[1] * d[2] - c[2] * d[1])
                    ) -
                    a[1] * (
                        b[0] * (c[2] * d[3] - c[3] * d[2]) -
                        b[2] * (c[0] * d[3] - c[3] * d[0]) +
                        b[3] * (c[0] * d[2] - c[2] * d[0])
                    ) +
                    a[2] * (
                        b[0] * (c[1] * d[3] - c[3] * d[1]) -
                        b[1] * (c[0] * d[3] - c[3] * d[0]) +
                        b[3] * (c[0] * d[1] - c[1] * d[0])
                    ) -
                    a[3] * (
                        b[0] * (c[1] * d[2] - c[2] * d[1]) -
                        b[1] * (c[0] * d[2] - c[2] * d[0]) +
                        b[2] * (c[0] * d[1] - c[1] * d[0])
                    );

                steps = `Determinant of 4x4 matrix:\n = ${a[0]} * [M11] - ${a[1]} * [M12] + ${a[2]} * [M13] - ${a[3]} * [M14]\n
                Where Mij is the determinant of the 3x3 matrix obtained by removing row i and column j.\n
                = ${determinant}`;
            }
            return steps.split('\n').map(line => `<div class="step">${line.trim()}</div>`).join('');
        }

        function calculateInverseSteps(matrix, inverseMatrix) {
            const steps = `
            To find the inverse of a square matrix, we use the formula:
            A^(-1) = (1/det(A)) * adj(A)

            Steps to calculate:
            1. Calculate the determinant of the matrix (already calculated).
            2. If the determinant is 0, the matrix is singular and does not have an inverse.
            3. Compute the matrix of minors for each element.
            4. Compute the matrix of cofactors.
            5. Transpose the cofactor matrix to get the adjugate matrix.
            6. Multiply each element of the adjugate matrix by (1/det(A)) to get the inverse.

            Resulting Inverse Matrix:
            ${matrixToString(inverseMatrix)}
            `;
            return steps.split('\n').map(line => `<div class="step">${line.trim()}</div>`).join('');
        }
    </script>

</body>
</html>

